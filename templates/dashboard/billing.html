{% extends "default.html" %}

{% block title %}è´¦å•{% endblock %}
{% block head %}{% endblock %}
{% block default_content %}

  <div class="card">
    <div class="card-body">
      <h1 class="h3 mb-5">è´¦å•</h1>
      {% if sub.cancelled %}

        <p>
         æ‚¨ä½¿ç”¨çš„æ˜¯ <b>{{ sub.plan_name() }}</b> è®¡åˆ’ã€‚
        <br />
        æ‚¨å·²å–æ¶ˆè®¢é˜…ï¼Œè®¢é˜…å°†äº {{ sub.next_bill_date.strftime("%Y-%m-%d") }} ç»“æŸ
        </p>
        <p class="alert alert-info">
          å¦‚æœæ‚¨æ”¹å˜ä¸»æ„ï¼Œæ‚¨å¯ä»¥å†æ¬¡è®¢é˜… åŸé‚®é‚®ç®±ï¼Œä½†
          è¯·æ³¨æ„ï¼Œè¿™å°†æ˜¯ä¸€ä¸ªå®Œå…¨
          æ–°çš„è®¢é˜…ï¼Œå¹¶ä¸”
          æ‚¨çš„ä»˜æ¬¾æ–¹å¼å°†<b>ç«‹å³</b>æ‰£æ¬¾ã€‚
          <br />
          å½“å‰è®¢é˜…çš„å‰©ä½™æœŸé™ä¸äºˆè€ƒè™‘ã€‚
          <br />
          <a href="{{ url_for("dashboard.pricing") }}"
             class="btn btn-primary mt-2">é‡æ–°è®¢é˜…</a>
        </p>
      {% else %}
        <p>
          æ‚¨ä½¿ç”¨çš„æ˜¯ <b>{{ sub.plan_name() }}</b> è®¡åˆ’ã€‚éå¸¸æ„Ÿè°¢æ‚¨æ”¯æŒåŸé‚®é‚®ç®±ã€‚ğŸ™Œ
          <br />
          ä¸‹ä¸€ä¸ªè®¡è´¹å‘¨æœŸå¼€å§‹äº {{ sub.next_bill_date.strftime("%Y-%m-%d") }}.
        </p>
        <div class="mt-3">
          å•å‡»æ­¤å¤„æ›´æ–°æˆ‘ä»¬çš„ä»˜æ¬¾åˆä½œä¼™ä¼´ Paddle çš„è´¦å•ä¿¡æ¯ï¼š
          <br />
          <a class="btn btn-outline-success mt-2" href="{{ sub.update_url }}">æ›´æ–°å¸å•ä¿¡æ¯</a>
        </div>
        <hr />
        <div class="mt-6">
          <h4>å˜æ›´è®¡åˆ’</h4>
          æ‚¨å¯ä»¥éšæ—¶æ›´æ”¹è®¡åˆ’ã€‚
          <br />
          è¯·æ³¨æ„ï¼Œæ–°çš„è®¡è´¹å‘¨æœŸç«‹å³å¼€å§‹
          å³ï¼Œå½“æ‚¨ä»æœˆåº¦è®¡åˆ’åˆ‡æ¢æˆ–åä¹‹äº¦ç„¶æ—¶ï¼Œæ‚¨å°†<b>ç«‹å³</b>æ”¯ä»˜å¹´è´¹ï¼ˆ$36ï¼‰
          <b>æ— éœ€æŒ‰æ¯”ä¾‹è®¡ç®—</b>ã€‚
          <br />
          è¦æ›´æ”¹è®¡åˆ’ï¼Œæ‚¨ä¹Ÿå¯ä»¥åœ¨<b>è®¡åˆ’ç»“æŸ</b>å‰å–æ¶ˆå½“å‰è®¡åˆ’å¹¶è®¢é˜…æ–°è®¡åˆ’ã€‚
          {% if sub.plan == PlanEnum.yearly %}

            <form method="post"
                  onsubmit="return confirm('è¿™å°†æ›´æ”¹æ‚¨å½“å‰çš„è®¢é˜…è®¡åˆ’ï¼Œè¯·ç¡®è®¤');">
              <input type="hidden" name="form-name" value="change-monthly">
              <button class="btn btn-outline-primary mt-2">æ›´æ”¹ä¸ºæœˆåº¦è®¡åˆ’</button>
            </form>
          {% else %}
            <form method="post"
                  onsubmit="return confirm('è¿™å°†æ›´æ”¹æ‚¨å½“å‰çš„è®¢é˜…è®¡åˆ’ï¼Œè¯·ç¡®è®¤');">
              <input type="hidden" name="form-name" value="change-yearly">
              <button class="btn btn-outline-primary mt-2">æ›´æ”¹ä¸ºå¹´åº¦è®¡åˆ’</button>
            </form>
          {% endif %}
        </div>
        <hr />
        <div>
          <h4>å–æ¶ˆè®¢é˜…</h4>
          ä¸æƒ³å†ä¿æŠ¤æ‚¨çš„æ”¶ä»¶é‚®ç®±äº†å—ï¼Ÿ
          <br />
          <form method="post">
            <input type="hidden" name="form-name" value="cancel">
            <span class="cancel btn btn-outline-danger mt-2">
              å–æ¶ˆè®¢é˜… <i class="fe fe-alert-triangle text-danger"></i>
            </span>
          </form>
        </div>
      {% endif %}
    </div>
  </div>
{% endblock %}
{% block script %}

  <script>
    $(".cancel").on("click", function (e) {
      let that = $(this);

      bootbox.confirm({
        message: "æ­¤æ“ä½œä¸å¯é€†ï¼Œè¯·ç¡®è®¤ã€‚",
        buttons: {
          confirm: {
            label: 'å–æ¶ˆè®¢é˜…',
            className: 'btn-danger'
          },
          cancel: {
            label: 'å…³é—­',
            className: 'btn-outline-primary'
          }
        },
        callback: function (result) {
          if (result) {
            that.closest("form").submit();
          }
        }
      })
    });

  </script>
{% endblock %}
